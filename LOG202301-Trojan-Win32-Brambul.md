
## Malware reports
Before I begin the analysis, I looked into a few blogs how this malware is going to behave.

> Brambul malware is a malicious Windows 32-bit SMB worm that functions as a service dynamic link library file or a portable executable file often dropped and installed onto victims’ networks by dropper malware. When executed, the malware attempts to establish contact with victim systems and IP addresses on victims’ local subnets. If successful, the application attempts to gain unauthorized access via the SMB protocol (ports 139 and 445) by launching brute-force password attacks using a list of embedded passwords. Additionally, the malware generates random IP addresses for further attacks.<br>
[HIDDEN COBRA – Joanap Backdoor Trojan and Brambul Server Message Block Worm | CISA](https://www.cisa.gov/uscert/ncas/alerts/TA18-149A)

> Joanap, also known as “Hidden Cobra,” is a remote access tool that it is dropped on infected systems by the automated Brambul worm, which crawls from computer-to-computer and probes whether it can gain access using certain vulnerabilities.
Once installed on an infected computer, Joanap would allow the North Korean hackers to remotely access infected computers, gain root level (or near-total) access to infected computers and load additional malware onto infected computers, the government said. <br>
[U.S. Government Goes After North Korea's Joanap Botnet | Threatpost](https://threatpost.com/u-s-government-joanap-botnet/141366/)

## Basic static analysis
By using PeStudio, basic information can be observed as follows.
```
FileType   : Executable, 4D 5A MZ
Tooling    : Microsoft Visual C++ 6.0
Timestamps : Wed Oct 14 12:45:54 2009 | UTC
MD5        : 022AEB126D2D80E683F7F2A3EE920874
SHA1       : B71B6D9AF65C6AFC4AF9D546A330C097AAFE3592
SHA256     : BDD816B9D85947B9BD7F2462D6B177DD6DADFE83723FD4DDE4EDED130177B218
```
```
Malware detection by VirusTotal
e.g. Microsoft : Trojan:Win32/Brambul.A!dha
- Type : Trojan
- Platform :Win32
- Family : Brambul
- Variant : .A
- !Suffixes : !dha
```

![image](https://user-images.githubusercontent.com/120234772/212308340-0d9d815a-e959-451a-afc3-50f11fe890d9.png)

Regarding Dll and Function, I could discover interesting results.

![image](https://user-images.githubusercontent.com/120234772/212312609-017a16e5-b641-4d53-81ac-f971c4a86410.png)

In terms of string values, I used floss at this time and I could discover three suspicious blocks

1. Password (for brute-force attack)
2. Command, Path, Process
3. Error message 

```
// Password (for brute-force attack)
gmail-smtp-in.l.google.com
johnS203@yahoo.com
google.com
whiat1001@gmail.com
mail1234
mail123
mail1
web1234
web123
web1
mail
~!@#$%^&*()_+
!@#$%^&*()
!@#$%^&*(
!@#$%^&*
!@#$%^&
!@#$%^
111111
1111
4321
54321
1234567
12345
1234
asdfgh
asdfg
asdf
BUMBLE
angel
passwd
!@#$
root
!@#$%
admin
test1234
pass
654321
123456
password
db2admin
administrator
```

```
// Command, Path, Process
Windows Update
SOFTWARE\Microsoft\Windows\CurrentVersion\Run
cmd.exe /c "net share c$ /d"
cmd.exe /c "net share admin$ /d"
\lsasvc.exe
RT_RCDATA
wgudtr
Microsoft Windows Genuine Updater
%SystemRoot%\csrss.exe
%s\admin$\csrss.exe
wglmgr
Windows Genuine Logon Manager
cmd.exe /c "net share admin$"
```

```
// Error message 
runtime error 
TLOSS error\r\n
SING error\r\n
DOMAIN error\r\n
R6028\r\n- unable to initialize heap\r\n
R6027\r\n- not enough space for lowio initialization\r\n
R6026\r\n- not enough space for stdio initialization\r\n
R6025\r\n- pure virtual function call\r\n
R6024\r\n- not enough space for _onexit/atexit table\r\n
R6019\r\n- unable to open console device\r\n
R6018\r\n- unexpected heap error\r\n
R6017\r\n- unexpected multithread lock error\r\n
R6016\r\n- not enough space for thread data\r\n
abnormal program termination\r\n
R6009\r\n- not enough space for environment\r\n
R6008\r\n- not enough space for arguments\r\n
R6002\r\n- floating point not loaded\r\n
Microsoft Visual C++ Runtime Library
Runtime Error!
```


# Basic dynamic analysis
![image](https://user-images.githubusercontent.com/120234772/223443661-67808102-282f-457a-bf5e-a30dc943087e.png)

![image](https://user-images.githubusercontent.com/120234772/223443957-d88101a0-4960-4f7f-9de7-92126eb1dd10.png)


